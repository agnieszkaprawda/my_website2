---
categories:
- ""
- ""
date: "2017-10-31T21:28:43-05:00"
description: ""
draft: false
keywords: ""
slug: project2
title: "General Social Survey (GSS)"
image: project02.jpg
---



<p>The <a href="http://www.gss.norc.org/">General Social Survey (GSS)</a> gathers data on American society in order to monitor and explain trends in attitudes, behaviours, and attributes. Many trends have been tracked for decades, so one can see the evolution of attitudes, etc in American Society.</p>
<p>In this assignment we analyze data from the <strong>2016 GSS sample data</strong>, using it to estimate values of <em>population parameters</em> of interest about US adults. The GSS sample data file has 2867 observations of 935 variables, but we are only interested in very few of these variables and you are using a smaller file.</p>
<pre class="r"><code>gss &lt;- read_csv(here::here(&quot;data&quot;, 
                           &quot;smallgss2016.csv&quot;), 
                na = c(&quot;&quot;, &quot;Don&#39;t know&quot;,
                       &quot;No answer&quot;, 
                       &quot;Not applicable&quot;))</code></pre>
<p>We also noticed that many responses should not be taken into consideration, like “No Answer”, “Don’t Know”, “Not applicable”, “Refused to Answer”.</p>
<p>We will be creating 95% confidence intervals for population parameters. The variables we have are the following:</p>
<ul>
<li>hours and minutes spent on email weekly. The responses to these questions are recorded in the <code>emailhr</code> and <code>emailmin</code> variables. For example, if the response is 2.50 hours, this would be recorded as emailhr = 2 and emailmin = 30.</li>
<li><code>snapchat</code>, <code>instagrm</code>, <code>twitter</code>: whether respondents used these social media in 2016</li>
<li><code>sex</code>: Female - Male</li>
<li><code>degree</code>: highest education level attained</li>
</ul>
<div id="instagram-and-snapchat-by-sex" class="section level2">
<h2>Instagram and Snapchat, by sex</h2>
<p>In the first part of the proejct, we will try to answer the follwijg quesiton:</p>
<p>Can we estimate the <em>population</em> proportion of Snapchat or Instagram users in 2016?</p>
<p>We will create a new variable, <code>snap_insta</code> that is <em>Yes</em> if the respondent reported using any of Snapchat (<code>snapchat</code>) or Instagram (<code>instagrm</code>), and <em>No</em> if not. If the recorded value was NA for both of these questions, the value in your new variable should also be NA.</p>
<pre class="r"><code>gss_snapinsta&lt;-gss%&gt;%
  mutate(snap_insta= case_when(
    snapchat == &quot;Yes&quot; ~ &quot;Yes&quot;,
    instagrm == &quot;Yes&quot; ~ &quot;Yes&quot;,
    snapchat == &quot;No&quot; &amp; instagrm == &quot;No&quot;~ &quot;No&quot;,
    snapchat == &quot;NA&quot; || instagrm == &quot;NA&quot; ~ &quot;NA&quot;
  ))

gss_snapinsta</code></pre>
<pre><code>## # A tibble: 2,867 x 8
##    emailmin emailhr snapchat instagrm twitter sex    degree         snap_insta
##    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;chr&gt;     
##  1 0        12      NA       NA       NA      Male   Bachelor       NA        
##  2 30       0       No       No       No      Male   High school    No        
##  3 NA       NA      No       No       No      Male   Bachelor       No        
##  4 10       0       NA       NA       NA      Female High school    NA        
##  5 NA       NA      Yes      Yes      No      Female Graduate       Yes       
##  6 0        2       No       Yes      No      Female Junior college Yes       
##  7 0        40      NA       NA       NA      Male   High school    NA        
##  8 NA       NA      Yes      Yes      No      Female High school    Yes       
##  9 0        0       NA       NA       NA      Male   High school    NA        
## 10 NA       NA      No       No       No      Male   Junior college No        
## # … with 2,857 more rows</code></pre>
<p>Now we will calculate the proportion of Yes’s for <code>snap_insta</code> among those who answered the question, i.e. excluding NAs</p>
<pre class="r"><code>proportion_yes&lt;- gss_snapinsta %&gt;% 
  count(snap_insta) %&gt;% 
  pivot_wider(names_from=snap_insta , values_from=n) %&gt;% 
  mutate(prop_yes=Yes/(No+Yes))
  
proportion_yes</code></pre>
<pre><code>## # A tibble: 1 x 4
##    `NA`    No   Yes prop_yes
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
## 1  1495   858   514    0.375</code></pre>
<p>Using the CI formula for proportions, we will construct 95% CIs for men and women who used either Snapchat or Instagram</p>
<pre class="r"><code>proportion_yes_gender&lt;- gss_snapinsta %&gt;% 
  group_by(sex) %&gt;% 
  count(snap_insta) %&gt;% 
  pivot_wider(names_from=snap_insta , values_from=n) %&gt;% 
  mutate(prop_yes=Yes/(No+Yes)) 
proportion_yes_gender</code></pre>
<pre><code>## # A tibble: 2 x 5
## # Groups:   sex [2]
##   sex     `NA`    No   Yes prop_yes
##   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
## 1 Female   822   447   322    0.419
## 2 Male     673   411   192    0.318</code></pre>
<pre class="r"><code>siciwomen &lt;- proportion_yes_gender %&gt;% 
  filter(sex==&quot;Female&quot;)%&gt;% 
  mutate(standard_error=sqrt((prop_yes*(1-prop_yes)/(Yes+No)))) %&gt;% 
  summarise(lower_95=prop_yes-1.96*standard_error, upper_95=prop_yes+1.96*standard_error) %&gt;% 
  summarise(Confidence_Interval_Female=c(lower_95,upper_95))
siciwomen</code></pre>
<pre><code>## # A tibble: 2 x 1
##   Confidence_Interval_Female
##                        &lt;dbl&gt;
## 1                      0.384
## 2                      0.454</code></pre>
<pre class="r"><code>sicimen &lt;- proportion_yes_gender %&gt;% 
  filter(sex==&quot;Male&quot;)%&gt;% 
  mutate(standard_error=sqrt((prop_yes*(1-prop_yes)/(Yes+No)))) %&gt;% 
  summarise(lower_95=prop_yes-1.96*standard_error, upper_95=prop_yes+1.96*standard_error) %&gt;% 
  summarise(Confidence_Interval_Male=c(lower_95,upper_95))
sicimen  </code></pre>
<pre><code>## # A tibble: 2 x 1
##   Confidence_Interval_Male
##                      &lt;dbl&gt;
## 1                    0.281
## 2                    0.356</code></pre>
</div>
<div id="twitter-by-education-level" class="section level2">
<h2>Twitter, by education level</h2>
<p>In this part we will concentrate on another quesiton:
Can we estimate the <em>population</em> proportion of Twitter users by education level in 2016?.</p>
<p>There are 5 education levels in variable <code>degree</code> which, in ascending order of years of education, are Lt high school, High School, Junior college, Bachelor, Graduate.</p>
<p>We will turn <code>degree</code> from a character variable into a factor variable. We will make sure the order is the correct one and that levels are not sorted alphabetically which is what R by default does.</p>
<pre class="r"><code>factor_degree&lt;- gss %&gt;% 
  na.omit(degree) %&gt;% 
  mutate(degree = factor(degree, 
                         levels = c(&quot;Lt high school&quot;, 
                                    &quot;High School&quot;, 
                                    &quot;Junior college&quot;, 
                                    &quot;Bachelor&quot;, 
                                    &quot;Graduate&quot;))) %&gt;% 
  arrange((degree))</code></pre>
<p>Thereafter, we will create a new variable, <code>bachelor_graduate</code> that is <em>Yes</em> if the respondent has either a <code>Bachelor</code> or <code>Graduate</code> degree. As before, if the recorded value for either was NA, the value in our new variable should also be NA.</p>
<pre class="r"><code>bach_grad&lt;-factor_degree%&gt;%
  mutate(bachelor_graduate= case_when(
    degree == &quot;Bachelor&quot; ~ &quot;Yes&quot;,
    degree == &quot;Graduate&quot; ~ &quot;Yes&quot;,
    degree != &quot;Graduate&quot;&amp; degree != &quot;Bachelor&quot; ~ &quot;No&quot;,
    TRUE ~ &quot;NA&quot;
  ))</code></pre>
<p>Now, we will calculate the proportion of <code>bachelor_graduate</code> who do (Yes) and who don’t (No) use twitter.</p>
<pre class="r"><code>proportion_twitter_bachgrad&lt;- bach_grad %&gt;% 
  filter(bachelor_graduate==&quot;Yes&quot;) %&gt;% 
  count(twitter)%&gt;% 
  pivot_wider(names_from=twitter , values_from=n) %&gt;% 
  mutate(proportion_yes_twitter=Yes/(No+Yes), proportion_no_twitter=No/(Yes+No))

proportion_twitter_bachgrad</code></pre>
<pre><code>## # A tibble: 1 x 5
##    `NA`    No   Yes proportion_yes_twitter proportion_no_twitter
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;                  &lt;dbl&gt;                 &lt;dbl&gt;
## 1   365   375   114                  0.233                 0.767</code></pre>
<p>Using the CI formula for proportions,we will again construct two 95% CIs for <code>bachelor_graduate</code> vs whether they use (Yes) and don’t (No) use twitter.</p>
<pre class="r"><code>sicitwitter_yes &lt;- proportion_twitter_bachgrad %&gt;% 
  mutate(standard_error=sqrt((proportion_yes_twitter*(1-proportion_yes_twitter)/(Yes+No)))) %&gt;% 
  summarise(lower_95=proportion_yes_twitter-1.96*standard_error, upper_95=proportion_yes_twitter+1.96*standard_error) %&gt;% 
  summarise(Confidence_Interval_Yes_Twitter=c(lower_95,upper_95))
sicitwitter_yes</code></pre>
<pre><code>## # A tibble: 2 x 1
##   Confidence_Interval_Yes_Twitter
##                             &lt;dbl&gt;
## 1                           0.196
## 2                           0.271</code></pre>
<pre class="r"><code>sicitwitter_no &lt;- proportion_twitter_bachgrad %&gt;% 
  mutate(standard_error=sqrt((proportion_no_twitter*(1-proportion_no_twitter)/(Yes+No)))) %&gt;% 
  summarise(lower_95=proportion_no_twitter-1.96*standard_error, upper_95=proportion_no_twitter+1.96*standard_error) %&gt;% 
  summarise(Confidence_Interval_No_Twitter=c(lower_95,upper_95))
sicitwitter_no  </code></pre>
<pre><code>## # A tibble: 2 x 1
##   Confidence_Interval_No_Twitter
##                            &lt;dbl&gt;
## 1                          0.729
## 2                          0.804</code></pre>
<p>The two Confidence Intervals do not overlap. Hence, we can reject the hypothesis that the difference in proprotions between Bachelor graduates who use twitter vs who do not use it is insignificant.</p>
</div>
<div id="email-usage" class="section level2">
<h2>Email usage</h2>
<p>Time for another quesiton to be answred:
Can we estimate the <em>population</em> parameter on time spent on email weekly?</p>
<p>First, we will create a new variable called <code>email</code> that combines <code>emailhr</code> and <code>emailmin</code> to reports the number of minutes the respondents spend on email weekly.</p>
<pre class="r"><code>glimpse(gss)</code></pre>
<pre><code>## Rows: 2,867
## Columns: 7
## $ emailmin &lt;chr&gt; &quot;0&quot;, &quot;30&quot;, &quot;NA&quot;, &quot;10&quot;, &quot;NA&quot;, &quot;0&quot;, &quot;0&quot;, &quot;NA&quot;, &quot;0&quot;, &quot;NA&quot;, &quot;0&quot;,…
## $ emailhr  &lt;chr&gt; &quot;12&quot;, &quot;0&quot;, &quot;NA&quot;, &quot;0&quot;, &quot;NA&quot;, &quot;2&quot;, &quot;40&quot;, &quot;NA&quot;, &quot;0&quot;, &quot;NA&quot;, &quot;2&quot;,…
## $ snapchat &lt;chr&gt; &quot;NA&quot;, &quot;No&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;Yes&quot;, &quot;NA&quot;, &quot;No&quot;…
## $ instagrm &lt;chr&gt; &quot;NA&quot;, &quot;No&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;NA&quot;, &quot;Yes&quot;, &quot;NA&quot;, &quot;No…
## $ twitter  &lt;chr&gt; &quot;NA&quot;, &quot;No&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;No&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;No&quot;, &quot;NA&quot;, &quot;No&quot;, …
## $ sex      &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Female&quot;, &quot;Female&quot;, &quot;Female&quot;, &quot;Male&quot;…
## $ degree   &lt;chr&gt; &quot;Bachelor&quot;, &quot;High school&quot;, &quot;Bachelor&quot;, &quot;High school&quot;, &quot;Gradu…</code></pre>
<pre class="r"><code>skim(gss)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">gss</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2867</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">7</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">7</td>
</tr>
<tr class="odd">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emailmin</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">15</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">emailhr</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">42</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">snapchat</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">instagrm</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">twitter</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">degree</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>email_gss&lt;-gss %&gt;%
  transform(emailhr= as.numeric(emailhr)) %&gt;%
  transform(emailmin= as.numeric(emailmin)) %&gt;% 
  mutate(email=(emailhr*60)+emailmin) %&gt;% 
  arrange(desc(email))
skim(email_gss)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-8">Table 1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">email_gss</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">2867</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">8</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">5</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">snapchat</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">instagrm</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">twitter</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">sex</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">degree</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">emailmin</td>
<td align="right">1218</td>
<td align="right">0.58</td>
<td align="right">3.32</td>
<td align="right">9.26</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">59</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="left">emailhr</td>
<td align="right">1218</td>
<td align="right">0.58</td>
<td align="right">6.89</td>
<td align="right">11.37</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">100</td>
<td align="left">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="left">email</td>
<td align="right">1218</td>
<td align="right">0.58</td>
<td align="right">416.84</td>
<td align="right">680.15</td>
<td align="right">0</td>
<td align="right">50</td>
<td align="right">120</td>
<td align="right">480</td>
<td align="right">6000</td>
<td align="left">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
<p>Now, we will visualise the distribution of this new variable. We will find the mean and the median number of minutes respondents spend on email weekly.</p>
<pre class="r"><code>ggplot(email_gss, aes(y=email)) +
  geom_boxplot(orientation=&quot;x&quot;)+
  scale_y_log10() +
  theme_bw()+ 
  theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())+
  labs(title=&quot;Most Employees spend over 100 Minutes on Emails a Week!&quot;,
       y=&quot;Email Minutes&quot;
       )</code></pre>
<p><img src="/projects/project2_files/figure-html/unnamed-chunk-9-1.png" width="648" style="display: block; margin: auto;" /></p>
<p>Using the <code>infer</code> package, we will calculate a 95% bootstrap confidence interval for the mean amount of time Americans spend on email weekly. Then, we will interpret this interval in context of the data, reporting its endpoints in “humanized” units (e.g. instead of 108 minutes, report 1 hr and 8 minutes).</p>
<pre class="r"><code>bootstrap_email_ci &lt;- email_gss%&gt;%
  #select(email)%&gt;%
  specify(response=email)%&gt;%
  generate(reps=1000,
           type=&quot;bootstrap&quot;)%&gt;%
  calculate(stat=&quot;mean&quot;)%&gt;%
  get_ci(level = 0.975, type = &quot;percentile&quot;, point_estimate = NULL) %&gt;% 
  mutate(lower_ci=times(lower_ci%/%60 +lower_ci%%60/60)/24) %&gt;% 
  mutate(upper_ci=times(upper_ci%/%60 +upper_ci%%60/60)/24) #%&gt;% 
  #mutate(lower_ci=lubridate::as.period(lower_ci,hours)

bootstrap_email_ci</code></pre>
<pre><code>## # A tibble: 1 x 2
##   lower_ci upper_ci
##   &lt;times&gt;  &lt;times&gt; 
## 1 06:19:10 07:33:34</code></pre>
<p>Now we will build a 99% Confidence Interval. We are sure it will be broader than the 95% interval as with the bigger probability the range of values we onclude in our interval goes broader.</p>
<pre class="r"><code>#wider since as CI approaches 100% SE approaches infinity, heres a sanity check

bootstrap_email_ci_check &lt;- email_gss%&gt;%
  #select(email)%&gt;%
  specify(response=email)%&gt;%
  generate(reps=1000,
           type=&quot;bootstrap&quot;)%&gt;%
  calculate(stat=&quot;mean&quot;)%&gt;%
  get_ci(level = 0.995, 
         type = &quot;percentile&quot;, 
         point_estimate = NULL) %&gt;%
  #mutate(lower_ci=hms::hms(hours=6,min=17,sec=20))
   mutate(lower_ci=times(lower_ci%/%60 +lower_ci%%60/60)/24) %&gt;% 
   mutate(upper_ci=times(upper_ci%/%60 +upper_ci%%60/60)/24) #%&gt;% 


bootstrap_email_ci_check</code></pre>
<pre><code>## # A tibble: 1 x 2
##   lower_ci upper_ci
##   &lt;times&gt;  &lt;times&gt; 
## 1 06:10:29 07:44:00</code></pre>
</div>
